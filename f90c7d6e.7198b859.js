(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{153:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return r})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return o}));var c=n(3),a=n(7),b=(n(0),n(161)),i={title:"5-4 \u9801\u9762\u8f09\u5165\u6642\u5c31\u53bb\u8acb\u6c42\u8cc7\u6599 - useEffect \u7684\u57fa\u672c\u4f7f\u7528",keywords:["React Hooks","useEffect"]},r={unversionedId:"book/ch5/5-4",id:"book/ch5/5-4",isDocsHomePage:!1,title:"5-4 \u9801\u9762\u8f09\u5165\u6642\u5c31\u53bb\u8acb\u6c42\u8cc7\u6599 - useEffect \u7684\u57fa\u672c\u4f7f\u7528",description:"\u672c\u55ae\u5143\u5c0d\u61c9\u7684\u5c08\u6848\u5206\u652f\u70ba\uff1afetch-data-when-page-loaded-with-useEffect\u3002",source:"@site/docs/book/ch5/5-4.md",slug:"/book/ch5/5-4",permalink:"/react-bootcamp/docs/book/ch5/5-4",editUrl:"https://github.com/pjchender/react-bootcamp/edit/main/docs/book/ch5/5-4.md",version:"current",sidebar:"book",previous:{title:"5-3 \u4f7f\u7528 fetch \u62c9\u53d6\u5929\u6c23\u89c0\u6e2c\u8cc7\u6599",permalink:"/react-bootcamp/docs/book/ch5/5-3"},next:{title:"5-5 \u5be6\u4f5c\u8cc7\u6599\u8f09\u5165\u4e2d\u7684\u72c0\u614b",permalink:"/react-bootcamp/docs/book/ch5/5-5"}},p=[{value:"\u55ae\u5143\u6838\u5fc3",id:"\u55ae\u5143\u6838\u5fc3",children:[]},{value:"useEffect \u7684\u57fa\u672c\u4f7f\u7528",id:"useeffect-\u7684\u57fa\u672c\u4f7f\u7528",children:[]},{value:"\u89c0\u5bdf useEffect \u4e2d\u51fd\u5f0f\u88ab\u57f7\u884c\u7684\u6642\u9593\u9ede",id:"\u89c0\u5bdf-useeffect-\u4e2d\u51fd\u5f0f\u88ab\u57f7\u884c\u7684\u6642\u9593\u9ede",children:[{value:"\u95dc\u9589 React.StrictMode",id:"\u95dc\u9589-reactstrictmode",children:[]}]},{value:"\u5982\u679c\u5143\u4ef6\u9700\u8981\u91cd\u65b0\u8f49\u8b6f\u5462",id:"\u5982\u679c\u5143\u4ef6\u9700\u8981\u91cd\u65b0\u8f49\u8b6f\u5462",children:[]},{value:"\u5728\u7b2c\u4e00\u6b21\u8f09\u5165\u7db2\u9801\u6642\u66f4\u65b0\u8cc7\u6599",id:"\u5728\u7b2c\u4e00\u6b21\u8f09\u5165\u7db2\u9801\u6642\u66f4\u65b0\u8cc7\u6599",children:[]},{value:"\u70ba\u4ec0\u9ebc\u6703\u9677\u5165\u7121\u9650\u8ff4\u5708",id:"\u70ba\u4ec0\u9ebc\u6703\u9677\u5165\u7121\u9650\u8ff4\u5708",children:[]},{value:"\u5982\u4f55\u8b93 useEffect \u5167\u7684\u51fd\u5f0f\u6709\u689d\u4ef6\u7684\u4e0d\u88ab\u547c\u53eb",id:"\u5982\u4f55\u8b93-useeffect-\u5167\u7684\u51fd\u5f0f\u6709\u689d\u4ef6\u7684\u4e0d\u88ab\u547c\u53eb",children:[]},{value:"useEffect \u4e2d\u7684 dependencies \u9663\u5217",id:"useeffect-\u4e2d\u7684-dependencies-\u9663\u5217",children:[]},{value:"useEffect \u7684 effect \u6307\u7684\u662f\u4ec0\u9ebc",id:"useeffect-\u7684-effect-\u6307\u7684\u662f\u4ec0\u9ebc",children:[]},{value:"\u63db\u4f60\u4e86\uff01\u8b93\u9801\u9762\u4e00\u8f09\u5165\u5c31\u81ea\u52d5\u66f4\u65b0\u8cc7\u6599\u5427",id:"\u63db\u4f60\u4e86\uff01\u8b93\u9801\u9762\u4e00\u8f09\u5165\u5c31\u81ea\u52d5\u66f4\u65b0\u8cc7\u6599\u5427",children:[{value:"\u5716\u4e00",id:"\u5716\u4e00",children:[]},{value:"\u5716\u4e8c",id:"\u5716\u4e8c",children:[]},{value:"\u5716\u4e09",id:"\u5716\u4e09",children:[]}]}],l={toc:p};function o(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(b.b)("wrapper",Object(c.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(b.b)("p",null,"\u672c\u55ae\u5143\u5c0d\u61c9\u7684\u5c08\u6848\u5206\u652f\u70ba\uff1a",Object(b.b)("a",Object(c.a)({parentName:"p"},{href:"https://github.com/pjchender/learn-react-from-hook-realtime-weather-app/tree/fetch-data-when-page-loaded-with-useEffect"}),Object(b.b)("inlineCode",{parentName:"a"},"fetch-data-when-page-loaded-with-useEffect")),"\u3002"),Object(b.b)("h2",{id:"\u55ae\u5143\u6838\u5fc3"},"\u55ae\u5143\u6838\u5fc3"),Object(b.b)("p",null,"\u9019\u500b\u55ae\u5143\u7684\u4e3b\u8981\u76ee\u6a19\u5305\u542b\uff1a"),Object(b.b)("ul",{className:"contains-task-list"},Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u4e86\u89e3 useEffect \u7684\u4f7f\u7528"),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u4e86\u89e3 useEffect \u4e2d\u51fd\u5f0f\u6703\u88ab\u57f7\u884c\u7684\u6642\u9593\u9ede"),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u4e86\u89e3 useEffect \u4e2d dependencies array \u5c0d\u5176\u51fd\u5f0f\u57f7\u884c\u7684\u5f71\u97ff"),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u900f\u904e useEffect \u8b93\u9801\u9762\u8f09\u5165\u6642\u5373\u66f4\u65b0\u5929\u6c23\u8cc7\u6599")),Object(b.b)("hr",null),Object(b.b)("p",null,"\u5728\u4e0a\u4e00\u500b\u55ae\u5143\u4e2d\uff0c\u6211\u5011\u5df2\u7d93\u53ef\u4ee5\u900f\u904e\u8b93\u4f7f\u7528\u8005\u9ede\u64ca\u6309\u9215\u4f86\u66f4\u65b0\u5929\u6c23\u8cc7\u8a0a\uff0c\u4f46\u5be6\u969b\u4e0a\uff0c\u6bd4\u8f03\u597d\u7684\u505a\u6cd5\u61c9\u8a72\u662f\u5728\u4f7f\u7528\u8005\u8f09\u5165\u9801\u9762\u7684\u6642\u5019\uff0c\u5c31\u53bb\u53d6\u5f97\u6700\u65b0\u7684\u8cc7\u6599\u56de\u4f86\u986f\u793a\uff1b\u5982\u679c\u4f7f\u7528\u8005\u60f3\u8981\u770b\u6700\u65b0\u7684\u8cc7\u6599\uff0c\u518d\u6309\u4e0b\u91cd\u65b0\u6574\u7406\u7684\u6309\u9215\u4f86\u66f4\u65b0\u8cc7\u6599\u3002\u56e0\u6b64\uff0c\u73fe\u5728\u5c31\u8b93\u6211\u5011\u4f86\u770b\u4e00\u4e0b\uff0c\u8981\u5982\u4f55\u5728\u9801\u9762\u4e00\u8f09\u5165\u6642\u5c31\u53bb\u767c\u9001 API \u8acb\u6c42\u62c9\u53d6\u8cc7\u6599\u5462\uff1f"),Object(b.b)("p",null,"\u9019\u88e1\u6211\u5011\u6703\u78b0\u5230\u672c\u66f8\u4ee5\u4f86\u7684\u7b2c\u4e8c\u500b React Hooks\uff0c\u7a31\u4f5c ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect"),"\u3002"),Object(b.b)("p",null,"\u500b\u4eba\u8a8d\u70ba ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u662f\u6574\u500b React Hooks \u4e2d\u9700\u8981\u82b1\u6700\u591a\u6642\u9593\u53bb\u7406\u89e3\u548c\u6d88\u5316\u7684 Hook\uff0c\u5176\u4e2d\u5f88\u5927\u90e8\u5206\u539f\u56e0\u5728\u65bc ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u548c\u904e\u53bb\u5b78\u7fd2\u5230\u7684\u751f\u547d\u9031\u671f\u6982\u5ff5\u7d81\u5f97\u5f88\u6df1\uff0c\u56e0\u6b64\u5c0d\u65bc\u975e\u521d\u6b21\u5b78\u7fd2 React \u7684\u958b\u767c\u8005\u4f86\u8aaa\uff0c\u5b78\u7fd2\u7684\u6642\u5019\u6703\u4e0d\u81ea\u89ba\u60f3\u8981\u628a\u820a\u7684\u601d\u8003\u6a21\u5f0f\u5957\u7528\u5230 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u9019\u500b Hook\u3002"),Object(b.b)("p",null,"\u73fe\u5728\u5c31\u8b93\u6211\u5011\u4f86\u770b\u4e00\u4e0b ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u9019\u500b React Hook \u6700\u57fa\u672c\u7684\u7528\u6cd5\u3002"),Object(b.b)("h2",{id:"useeffect-\u7684\u57fa\u672c\u4f7f\u7528"},"useEffect \u7684\u57fa\u672c\u4f7f\u7528"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},"\u5148\u5f9e ",Object(b.b)("inlineCode",{parentName:"li"},"react")," \u4e2d\u8f09\u5165 ",Object(b.b)("inlineCode",{parentName:"li"},"useEffect"))),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{className:"language-js"}),"// ./src/App.js\nimport React, { useState, useEffect } from 'react';\n")),Object(b.b)("ol",{start:2},Object(b.b)("li",{parentName:"ol"},"\u63a5\u8457\u5728 App \u5143\u4ef6\u4e2d\u8a66\u8457\u4f7f\u7528 ",Object(b.b)("strong",{parentName:"li"},Object(b.b)("inlineCode",{parentName:"strong"},"useEffect"),"\uff0cuseEffect \u7684\u53c3\u6578\u4e2d\u9700\u8981\u5e36\u5165\u4e00\u500b\u51fd\u5f0f\uff0c\u800c\u9019\u500b\u51fd\u5f0f\u6703\u5728\u300c\u756b\u9762\u8f49\u8b6f\u5b8c\u6210\u300d\u5f8c\u88ab\u547c\u53eb"))),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{className:"language-js"}),"// ./src/App.js\n// ...\n\nconst App = () => {\n  const [currentTheme, setCurrentTheme] = useState('light');\n  const [currentWeather, setCurrentWeather] = useState({\n    /* ... */\n  });\n\n  // \u52a0\u5165 useEffect \u65b9\u6cd5\uff0c\u53c3\u6578\u662f\u9700\u8981\u653e\u5165\u51fd\u5f0f\n  useEffect(() => {});\n\n  return {\n    /* ... */\n  };\n};\n")),Object(b.b)("ol",{start:3},Object(b.b)("li",{parentName:"ol"},"\u6700\u5f8c\u6211\u5011\u5728\u5143\u4ef6\u4e2d\u7684\u5e7e\u500b\u4e0d\u540c\u4f4d\u7f6e\u4f7f\u7528 ",Object(b.b)("inlineCode",{parentName:"li"},"console.log()")," \u770b\u770b")),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{className:"language-jsx"}),"// ./src/App.js\n// ...\n\nconst App = () => {\n  console.log('invoke function component'); // \u5143\u4ef6\u4e00\u958b\u59cb\u52a0\u5165 console.log\n\n  const [currentTheme, setCurrentTheme] = useState('light');\n  const [currentWeather, setCurrentWeather] = useState({\n    /* ... */\n  });\n\n  useEffect(() => {\n    // useEffect \u4e2d console.log\n    console.log('execute function in useEffect');\n  });\n\n  return (\n    <Container>\n      {/* JSX \u4e2d\u52a0\u5165 console.log */}\n      {console.log('render')}\n      <WeatherCard>{/* ... */}</WeatherCard>\n    </Container>\n  );\n};\n")),Object(b.b)("p",null,"\u5728\u4e09\u500b\u4e0d\u540c\u7684\u4f4d\u7f6e\u4f7f\u7528 ",Object(b.b)("inlineCode",{parentName:"p"},"console.log()")," \u4f86\u770b\u57f7\u884c\u7684\u6642\u9593\u9ede\uff1a"),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/MSQJAOv.png",alt:"Imgur"}))),Object(b.b)("h2",{id:"\u89c0\u5bdf-useeffect-\u4e2d\u51fd\u5f0f\u88ab\u57f7\u884c\u7684\u6642\u9593\u9ede"},"\u89c0\u5bdf useEffect \u4e2d\u51fd\u5f0f\u88ab\u57f7\u884c\u7684\u6642\u9593\u9ede"),Object(b.b)("p",null,"\u7531\u65bc ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u9019\u500b\u65b9\u6cd5\u4f7f\u7528\u6642\u9700\u8981\u5728\u53c3\u6578\u4e2d\u5e36\u5165\u4e00\u500b\u51fd\u5f0f\uff0c\u56e0\u6b64\u900f\u904e ",Object(b.b)("inlineCode",{parentName:"p"},"console.log('execute function in useEffect');")," \u6211\u5011\u53ef\u4ee5\u89c0\u5bdf\u9019\u500b\u51fd\u5f0f\u88ab\u547c\u53eb\u7684\u6642\u9593\u9ede\u3002"),Object(b.b)("p",null,"\u73fe\u5728\u6253\u958b\u700f\u89bd\u5668\u7684\u958b\u767c\u8005\u5de5\u5177\uff0c\u5728 console \u9762\u677f\u4e2d\u4f60\u61c9\u8a72\u53ef\u4ee5\u770b\u5230 ",Object(b.b)("inlineCode",{parentName:"p"},"console.log")," \u7684\u8a0a\u606f\u5167\u5bb9\u4ee5\u5982\u4e0b\u7684\u9806\u5e8f\u51fa\u73fe\uff1a"),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/b0442Ma.png",alt:"Imgur"}))),Object(b.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-heading"}),Object(b.b)("h5",{parentName:"div"},Object(b.b)("span",Object(c.a)({parentName:"h5"},{className:"admonition-icon"}),Object(b.b)("svg",Object(c.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(b.b)("path",Object(c.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-content"}),Object(b.b)("p",{parentName:"div"},"\u5728 console \u9762\u677f\u6703\u770b\u5230\u6709\u8b66\u544a\u8a0a\u606f\u986f\u793a\uff1a\u300c'setCurrentTheme' is assigned a value but never used\u300d\uff0c\u9019\u500b\u8a0a\u606f\u6307\u7684\u662f\u5728 App \u5143\u4ef6\u4e2d\u6709\u5b9a\u7fa9\u4e86 ",Object(b.b)("inlineCode",{parentName:"p"},"setCurrentTheme")," \u9019\u500b\u65b9\u6cd5\uff0c\u4f46\u662f\u6c92\u6709\u88ab\u4f7f\u7528\u3002\u76ee\u524d\u8b80\u8005\u53ef\u4ee5\u5148\u5ffd\u7565\u9019\u500b\u8a0a\u606f\uff0c\u5728\u5f8c\u9762\u7684\u55ae\u5143\u4e2d\u8981\u81ea\u52d5\u5207\u63db\u4eae\uff0f\u6697\u8272\u4e3b\u984c\u6642\u624d\u6703\u7528\u9019\u500b\u65b9\u6cd5\u3002"))),Object(b.b)("h3",{id:"\u95dc\u9589-reactstrictmode"},"\u95dc\u9589 React.StrictMode"),Object(b.b)("p",null,"\u4f60\u6703\u767c\u73fe\u9019\u88e1\u96d6\u7136\u51fa\u73fe\u4e86\u5169\u6b21 invoke function component \u548c render\uff0c\u4f46\u5be6\u969b\u4e0a\u6211\u5011\u53ea\u9700\u8981\u770b\u65b9\u6846\u6a19\u8a3b\u7684\u5730\u65b9\u5373\u53ef\uff0c\u524d\u9762\u591a\u51fa\u4f86\u7684\u5169\u6b21\uff0c\u4e3b\u8981\u662f\u56e0\u70ba\u5728 ",Object(b.b)("inlineCode",{parentName:"p"},"index.js")," \u4e2d\uff0c\u9810\u8a2d\u4f7f\u7528\u4e86 ",Object(b.b)("inlineCode",{parentName:"p"},"<React.StrictMode>")," \u628a ",Object(b.b)("inlineCode",{parentName:"p"},"<App />")," \u5305\u4f4f\uff0c\u56e0\u6b64\u5b83\u6703\u53bb\u591a\u5e6b\u6211\u5011\u6aa2\u67e5\u5143\u4ef6\u7684\u4f7f\u7528\uff0c\u9032\u800c\u591a\u51fa\u4e86\u5169\u884c\u3002"),Object(b.b)("p",null,"\u9019\u88e1\u70ba\u4e86\u8b93\u8b80\u8005\u5c0d\u65bc ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u89f8\u767c\u7684\u6642\u9593\u9ede\u6709\u66f4\u6e05\u695a\u7684\u7406\u89e3\uff0c\u8b80\u8005\u53ef\u4ee5\u5148\u628a ",Object(b.b)("inlineCode",{parentName:"p"},"<React.StrictMode>")," \u62ff\u6389\uff1a"),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{className:"language-jsx"}),"// ./src/index.js\n\nReactDOM.render(<App />, document.getElementById('root'));\n")),Object(b.b)("p",null,"\u9019\u6642\u5019\u540c\u6a23\u900f\u904e\u5728\u700f\u89bd\u5668\u7684\u958b\u767c\u8005\u5de5\u5177\u4e2d\uff0c\u4f60\u5c07\u53ea\u6703\u770b\u5230\u5982\u4e0a\u5716\u65b9\u6846\u6a19\u8a3b\u4e2d\u4e09\u884c\u7684\u5167\u5bb9\uff1a"),Object(b.b)("p",null,"\u5716\u4e00\uff1a",Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/AXpqA0K.png",alt:"Imgur"}))),Object(b.b)("p",null,"\u4e5f\u5c31\u662f\u8aaa\uff0c ",Object(b.b)("strong",{parentName:"p"},Object(b.b)("inlineCode",{parentName:"strong"},"useEffect")," \u5167\u7684 function \u6703\u5728\u5143\u4ef6\u8f49\u8b6f\u5b8c\u5f8c\u88ab\u547c\u53eb"),"\uff0c\u8981\u6ce8\u610f\u7684\u662f\u300c",Object(b.b)("strong",{parentName:"p"},"\u8f49\u8b6f\u5b8c\u5f8c"),"\u300d\u624d\u6703\u547c\u53eb\uff0c\u5982\u679c\u4f60\u77e5\u9053 ",Object(b.b)("inlineCode",{parentName:"p"},"callback function")," \u7684\u6982\u5ff5\uff0c\u9019\u500b ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684\u51fd\u5f0f\u5c31\u5f88\u50cf\u662f\u5143\u4ef6\u8f49\u8b6f\u5b8c\u5f8c\u8981\u57f7\u884c\u7684 callback function\u3002"),Object(b.b)("p",null,"\u8ddf\u8457\u4e00\u8d77\u628a\u9019\u500b\u91cd\u8981\u7684\u89c0\u5ff5\u91cd\u8907\u5538\u4e00\u904d\uff1a",Object(b.b)("strong",{parentName:"p"},"\u5143\u4ef6\u8f49\u8b6f\u5b8c\u5f8c\u624d\u6703\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"strong"},"useEffect")," \u5167\u7684 function"),"\u3002"),Object(b.b)("h2",{id:"\u5982\u679c\u5143\u4ef6\u9700\u8981\u91cd\u65b0\u8f49\u8b6f\u5462"},"\u5982\u679c\u5143\u4ef6\u9700\u8981\u91cd\u65b0\u8f49\u8b6f\u5462"),Object(b.b)("p",null,"\u525b\u525b\u6211\u5011\u770b\u5230\u7684\u662f\u7db2\u9801\u91cd\u65b0\u6574\u7406\u5f8c\u7b2c\u4e00\u6b21\u8f09\u5165\u7db2\u9801\u7684\u60c5\u6cc1\uff0c\u90a3\u5982\u679c\u4f7f\u7528\u5230\u4e86 ",Object(b.b)("inlineCode",{parentName:"p"},"useState")," \u63d0\u4f9b\u7684 ",Object(b.b)("inlineCode",{parentName:"p"},"setSomething")," \u9019\u500b\u65b9\u6cd5\u6642\uff0c",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u7684\u51fd\u5f0f\u6703\u5728\u4ec0\u9ebc\u6642\u5019\u88ab\u547c\u53eb\u5462\uff1f"),Object(b.b)("p",null,"\u4f60\u53ef\u4ee5\u900f\u904e\u9ede\u64ca\u53f3\u4e0b\u89d2\u7684\u300c\u91cd\u65b0\u6574\u7406\u300d\u6309\u9215\u4f86\u89f8\u767c\u5143\u4ef6\u66f4\u65b0\u3002\u53ef\u4ee5\u770b\u5230\u7576\u6211\u5011\u4f7f\u7528 ",Object(b.b)("inlineCode",{parentName:"p"},"useState")," \u63d0\u4f9b\u7684 ",Object(b.b)("inlineCode",{parentName:"p"},"setSomething")," \u8b93\u89f8\u767c\u756b\u9762\u91cd\u65b0\u8f49\u8b6f\u6642\uff0c",Object(b.b)("inlineCode",{parentName:"p"},"console.log")," \u986f\u793a\u7684\u9806\u5e8f\u548c\u525b\u525b\u7b2c\u4e00\u6b21\u8f09\u5165\u7db2\u9801\u6642\u7684\u9806\u5e8f\u662f\u4e00\u6a23\u7684\uff0c\u56e0\u6b64\uff0c\u4e0d\u7ba1\u9019\u500b\u5143\u4ef6\u662f\u7b2c\u4e00\u6b21\u8f49\u8b6f\u9084\u662f\u91cd\u65b0\u8f49\u8b6f ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684 function \u4e00\u6a23\u6703\u5728\u5143\u4ef6\u8f49\u8b6f\u5b8c\u5f8c\u88ab\u547c\u53eb\u3002"),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/EPP9FAY.png",alt:"Imgur"}))),Object(b.b)("h2",{id:"\u5728\u7b2c\u4e00\u6b21\u8f09\u5165\u7db2\u9801\u6642\u66f4\u65b0\u8cc7\u6599"},"\u5728\u7b2c\u4e00\u6b21\u8f09\u5165\u7db2\u9801\u6642\u66f4\u65b0\u8cc7\u6599"),Object(b.b)("p",null,"\u73fe\u5728\u6211\u5011\u77e5\u9053 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684 function \u6703\u5728\u5143\u4ef6\u8f49\u8b6f\u5b8c\u5f8c\u88ab\u547c\u53eb\uff0c\u9019\u500b\u6642\u9593\u9ede\u525b\u597d\u975e\u5e38\u9069\u5408\u4f86\u547c\u53eb API \u4e26\u66f4\u65b0\u8cc7\u6599\uff0c\u65bc\u662f\uff0c\u6211\u5011\u53ef\u4ee5\u5728 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u5efa\u7acb\u4e00\u500b\u51fd\u5f0f\uff0c\u4e26\u628a\u62c9\u53d6\u4e26\u66f4\u65b0\u5143\u4ef6\u8cc7\u6599\u7684\u65b9\u6cd5\u653e\u9032\u53bb\uff08\u4e5f\u5c31\u662f ",Object(b.b)("inlineCode",{parentName:"p"},"handleClick")," \u7684\u65b9\u6cd5\uff09\uff1a"),Object(b.b)("ol",null,Object(b.b)("li",{parentName:"ol"},"\u628a\u539f\u672c\u7684 ",Object(b.b)("inlineCode",{parentName:"li"},"handleClick")," \u65b9\u6cd5\u6539\u540d\u70ba ",Object(b.b)("inlineCode",{parentName:"li"},"fetchCurrentWeather")),Object(b.b)("li",{parentName:"ol"},"\u5728 ",Object(b.b)("inlineCode",{parentName:"li"},"useEffect()")," \u7684\u51fd\u5f0f\u4e2d\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"li"},"fetchCurrentWeather"))),Object(b.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-heading"}),Object(b.b)("h5",{parentName:"div"},Object(b.b)("span",Object(c.a)({parentName:"h5"},{className:"admonition-icon"}),Object(b.b)("svg",Object(c.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(b.b)("path",Object(c.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"\u6ce8\u610f")),Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-content"}),Object(b.b)("p",{parentName:"div"},"\u8acb\u628a\u9019\u500b\u6bb5\u843d\u770b\u5b8c\u5f8c\u518d\u5be6\u4f5c\uff0c\u5426\u5247\u5c07\u6703\u9032\u5165\u7121\u7aae\u8ff4\u5708\uff01"))),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/XzKlrGU.png",alt:"Imgur"}))),Object(b.b)("p",null,"\u5b58\u6a94\u5f8c\u4f86\u770b\u4e00\u4e0b\u7d50\u679c\uff1a"),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/yLJvzE1.png?1",alt:"Imgur"}))),Object(b.b)("p",null,"\u7cdf\u7cd5\u4e86\uff01\u4f60\u6703\u767c\u73fe console \u4e0d\u65b7\u5674\u51fa\u65b0\u6771\u897f\uff0c\u9677\u5165\u4e86\u7121\u9650\u8ff4\u5708\uff01\uff01\uff01"),Object(b.b)("h2",{id:"\u70ba\u4ec0\u9ebc\u6703\u9677\u5165\u7121\u9650\u8ff4\u5708"},"\u70ba\u4ec0\u9ebc\u6703\u9677\u5165\u7121\u9650\u8ff4\u5708"),Object(b.b)("p",null,"\u6211\u5011\u5148\u4f86\u4e86\u89e3\u4e00\u4e0b\u70ba\u4ec0\u9ebc\u6703\u9677\u5165\u7121\u9650\u8ff4\u5708\u3002"),Object(b.b)("p",null,"\u9996\u5148\uff0c\u7576\u9801\u9762\u7b2c\u4e00\u6b21\u8f09\u5165\uff0c\u5143\u4ef6\u8f49\u8b6f\u5b8c\u6210\u5f8c\uff0c\u6703\u53bb\u57f7\u884c ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u7684\u51fd\u5f0f\uff0c\u800c\u9019\u500b\u51fd\u5f0f\u4e2d\u6703\u5728 ",Object(b.b)("inlineCode",{parentName:"p"},"fetchCurrentWeather")," \u53d6\u5f97 API \u56de\u61c9\u7684\u8cc7\u6599\u5f8c\uff0c\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"p"},"setCurrentWeather")," \u4f86\u66f4\u65b0\u756b\u9762\u4e0a\u7684\u8cc7\u6599\uff0c\u66f4\u65b0\u756b\u9762\u5c31\u8868\u793a\u8a72\u5143\u4ef6\u6703\u91cd\u65b0\u8f49\u8b6f\uff0c\u65bc\u662f\u8f49\u8b6f\u5b8c\u5f8c\u53c8\u6703\u518d\u6b21\u57f7\u884c ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u7684 ",Object(b.b)("inlineCode",{parentName:"p"},"fetchCurrentWeather")," \u65b9\u6cd5\uff0c\u63a5\u8457\u518d\u6b21\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"p"},"setCurrentWeather")," \u89f8\u767c\u756b\u9762\u91cd\u65b0\u8f49\u8b6f\uff0c\u7136\u5f8c ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u7684\u51fd\u5f0f\u518d\u6b21\u88ab\u547c\u53eb\uff0c\u63a5\u8457\u5c31\u7e7c\u7e8c\u4e0d\u65b7\u9019\u6a23\u7684\u5faa\u74b0......\u3002"),Object(b.b)("p",null,"\u6574\u500b\u6d41\u7a0b\u5c31\u50cf\u4e0b\u9762\u9019\u6a23\u7684\u6982\u5ff5\uff1a"),Object(b.b)("p",null,"\u5716\u4e8c",Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/4gITKFH.png",alt:"Imgur"}))),Object(b.b)("h2",{id:"\u5982\u4f55\u8b93-useeffect-\u5167\u7684\u51fd\u5f0f\u6709\u689d\u4ef6\u7684\u4e0d\u88ab\u547c\u53eb"},"\u5982\u4f55\u8b93 useEffect \u5167\u7684\u51fd\u5f0f\u6709\u689d\u4ef6\u7684\u4e0d\u88ab\u547c\u53eb"),Object(b.b)("p",null,"\u90a3\u9ebc\u8981\u600e\u9ebc\u505c\u6b62\u9019\u500b\u7121\u9650\u8ff4\u5708\u5462\uff1f"),Object(b.b)("p",null,"\u8981\u505c\u6b62\u9019\u500b\u7121\u9650\u8ff4\u5708\u6703\u9700\u8981\u5728\u300c\u7279\u5b9a\u6642\u9593\u300d\u8b93 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684\u51fd\u5f0f\u4e0d\u8981\u88ab\u547c\u53eb\u5230\u5c31\u53ef\u4ee5\uff0c\u9019\u500b\u300c\u7279\u5b9a\u6642\u9593\u300d\u901a\u5e38\u662f\u300c\u5df2\u7d93\u5411 API \u62c9\u53d6\u904e\u8cc7\u6599\u300d\u6216\u8005\u300cReact \u5167\u7684\u8cc7\u6599\u6c92\u6709\u8b8a\u52d5\u300d\u6642\u3002"),Object(b.b)("p",null,"\u524d\u9762\u6211\u5011\u77e5\u9053\uff0c",Object(b.b)("strong",{parentName:"p"},Object(b.b)("inlineCode",{parentName:"strong"},"useEffect")," \u5167\u7684\u51fd\u5f0f\u6703\u5728\u300c\u6bcf\u4e00\u6b21\u300d\u756b\u9762\u8f49\u8b6f\u5b8c\u5f8c\u88ab\u547c\u53eb"),"\uff0c\u597d\u5728 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u9084\u63d0\u4f9b\u4e86\u7b2c\u4e8c\u500b\u53c3\u6578 ",Object(b.b)("inlineCode",{parentName:"p"},"dependencies")," \u8b93\u6211\u5011\u4f7f\u7528\uff1a"),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{className:"language-js"}),"useEffect(<didUpdate>, [dependencies])\n")),Object(b.b)("p",null,"\u7b2c\u4e8c\u500b\u53c3\u6578\u7a31\u4f5c ",Object(b.b)("inlineCode",{parentName:"p"},"dependencies"),"\uff0c\u5b83\u662f\u4e00\u500b\u9663\u5217\uff0c",Object(b.b)("strong",{parentName:"p"},"\u53ea\u8981\u6bcf\u6b21\u91cd\u65b0\u8f49\u8b6f\u5f8c dependencies \u5167\u7684\u5143\u7d20\u6c92\u6709\u6539\u8b8a\uff0c\u4efb\u4f55 useEffect \u88e1\u9762\u7684\u51fd\u5f0f\u5c31\u4e0d\u6703\u88ab"),"\u57f7\u884c\uff01"),Object(b.b)("p",null,"\u6240\u4ee5 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684\u51fd\u5f0f\u6703\u5728\u5143\u4ef6\u8f49\u8b6f\u5b8c\u6210\u5f8c\u88ab\u547c\u53eb\uff0c\u73fe\u5728\u591a\u4e86\u4e00\u500b\u524d\u63d0\uff1a\u300c",Object(b.b)("strong",{parentName:"p"},"\u5143\u4ef6\u8f49\u8b6f\u5b8c\u5f8c\uff0c\u5982\u679c dependencies \u6709\u6539\u8b8a\uff0c\u624d\u6703\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"strong"},"useEffect")," \u5167\u7684 function"),"\u300d\u3002\u5177\u9ad4\u4f86\u8aaa\u662f\u4ec0\u9ebc\u610f\u601d\u5462\uff1f"),Object(b.b)("p",null,"\u73fe\u5728\u56de\u5230\u539f\u672c\u7684\u300c\u81fa\u7063\u597d\u5929\u6c23\u300d\u7684\u7a0b\u5f0f\u78bc\u4e2d\uff0c\u5728 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u5e36\u5165\u7b2c\u4e8c\u500b\u53c3\u6578\uff0c\u5e36\u5165\u4e00\u500b\u7a7a\u9663\u5217 ",Object(b.b)("inlineCode",{parentName:"p"},"[]"),"\u5c31\u597d\u3002\u5e36\u5165\u7a7a\u9663\u5217\u7684\u8a71\uff0c\u56e0\u70ba\u7a7a\u9663\u5217\u4e2d\u6c92\u6709\u5143\u7d20\uff0c\u81ea\u7136\u6c38\u9060\u90fd\u4e0d\u6703\u6539\u8b8a\uff0c\u56e0\u6b64\u5c31\u7b49\u540c\u65bc\u53ea\u6709\u5728\u9801\u9762\u8f09\u5165\u6642\u6703\u57f7\u884c useEffect \u4e2d\u51fd\u5f0f\u7684\u5167\u5bb9\uff1a"),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{className:"language-jsx"}),"// \u7b2c\u4e8c\u500b\u53c3\u6578\u653e\u5165\u7a7a\u9663\u5217\nuseEffect(() => {\n  console.log('execute function in useEffect');\n  fetchCurrentWeather();\n}, []);\n")),Object(b.b)("p",null,"\u9019\u6642\u5019\u6211\u5011\u91cd\u65b0\u6574\u7406\u9801\u9762\uff0c\u4e0d\u6703\u518d\u51fa\u73fe\u7121\u7aae\u8ff4\u5708\uff0c\u800c ",Object(b.b)("inlineCode",{parentName:"p"},"console.log")," \u7684\u9806\u5e8f\u5982\u4e0b\uff1a"),Object(b.b)("pre",null,Object(b.b)("code",Object(c.a)({parentName:"pre"},{}),"[\u5143\u4ef6\u521d\u6b21\u8f49\u8b6f]\ninvoke function component\nrender\nexecute function in useEffect\n\n[\u56e0\u70ba useEffect \u4e2d\u7684 fetchCurrentWeather \u51fd\u5f0f\u4e2d\u6709\u547c\u53eb\u4e86 setCurrentWeather\uff0c\u6240\u4ee5\u6703\u518d\u91cd\u65b0\u8f49\u8b6f\u756b\u9762]\ninvoke function component\nrender\n")),Object(b.b)("p",null,"\u6211\u5011\u53ef\u4ee5\u770b\u5230\uff0c\u9019\u500b\u5143\u4ef6\u88ab\u57f7\u884c\u4e86\u5169\u6b21\uff08\u6709\u5169\u6b21 ",Object(b.b)("inlineCode",{parentName:"p"},"invoke function component"),"\uff09\uff0c\u70ba\u4ec0\u9ebc\u6703\u57f7\u884c\u5169\u6b21\u5462\uff1f"),Object(b.b)("p",null,"\u5982\u4e0b\u5716\uff0c\u7b2c\u4e00\u6b21\u756b\u9762\u8f49\u8b6f\u5f8c\uff0c\u56e0\u70ba ",Object(b.b)("inlineCode",{parentName:"p"},"dependencies")," \u7684\u503c\u624d\u525b\u88ab\u5e36\u5165\uff0c\u6240\u4ee5\u6703\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684\u51fd\u5f0f\uff0c\u4e26\u547c\u53eb\u5230 ",Object(b.b)("inlineCode",{parentName:"p"},"setCurrentWeather")," \u9019\u500b\u65b9\u6cd5\uff0c\u4f7f\u5f97\u756b\u9762\u518d\u6b21\u8f49\u8b6f\uff1b\u7b2c\u4e8c\u6b21\u756b\u9762\u8f49\u8b6f\u5b8c\u5f8c\uff0c\u767c\u73fe ",Object(b.b)("inlineCode",{parentName:"p"},"dependencies")," \u9663\u5217\u6c92\u6709\u6539\u8b8a\uff08\u4e00\u6a23\u4ec0\u9ebc\u5143\u7d20\u90fd\u6c92\u6709\uff09\uff0c\u56e0\u6b64\u5c31\u4e0d\u6703\u518d\u6b21\u57f7\u884c ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684\u51fd\u5f0f\uff0c\u4e5f\u56e0\u6b64\u4e0d\u6703\u518d\u6b21\u547c\u53eb\u5230 ",Object(b.b)("inlineCode",{parentName:"p"},"setCurrentWeather"),"\uff0c\u5982\u6b64\u907f\u514d\u6389\u4e86\u7121\u7aae\u8ff4\u5708\u7684\u554f\u984c\uff1a"),Object(b.b)("p",null,"\u5716\u4e09\uff1a"),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/ecXdRQy.png",alt:"Imgur"}))),Object(b.b)("p",null,"\u5728\u4f7f\u7528 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u7684\u6642\u5019\u5927\u90e8\u5206\u90fd\u6703\u5e36\u5165\u9019\u7b2c\u4e8c\u500b ",Object(b.b)("inlineCode",{parentName:"p"},"dependencies")," \u53c3\u6578\uff0c\u53ea\u662f\u6703\u6839\u64da\u9700\u8981\u5728\u8a72\u9663\u5217\u4e2d\u653e\u5165\u4e0d\u540c\u5143\u7d20\u3002\u5728\u4eca\u5929\u7684\u4f8b\u5b50\u4e2d\uff0c\u70ba\u4e86\u907f\u514d\u5143\u4ef6\u4e00\u76f4\u7121\u7aae\u66f4\u65b0\u7684\u554f\u984c\uff0c\u56e0\u6b64\u6703\u5e36\u5165\u4e00\u500b\u7a7a\u9663\u5217\uff0c\u8b93 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u88e1\u7684\u9019\u500b\u51fd\u5f0f\u53ea\u6703\u88ab\u57f7\u884c\u4e00\u6b21\u3002"),Object(b.b)("h2",{id:"useeffect-\u4e2d\u7684-dependencies-\u9663\u5217"},"useEffect \u4e2d\u7684 dependencies \u9663\u5217"),Object(b.b)("p",null,"\u73fe\u5728\u6211\u5011\u77e5\u9053 useEffect \u4e2d\u51fd\u5f0f\u57f7\u884c\u7684\u6642\u9593\u9ede\u4e00\u5b9a\u6703\u662f\u5143\u4ef6\u8f49\u8b6f\u5b8c\u4e4b\u5f8c\uff0c\u81f3\u65bc\u9019\u500b\u51fd\u5f0f\u5230\u5e95\u6703\u4e0d\u6703\u88ab\u547c\u53eb\u5247\u53d6\u6c7a\u65bc dependencies \u9663\u5217\u4e2d\u7684\u5143\u7d20\u662f\u5426\u76f8\u540c\uff08Same-value equality\uff09\u3002"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"\u5927\u5bb6\u53ef\u4ee5\u628a dependencies \u9663\u5217\u4e2d\u653e\u5165\u7684\u5143\u7d20\u7576\u4f5c\u662f\u300c\u88ab\u89c0\u5bdf\u300d\u7684\u8b8a\u6578\uff0c\u4f60\u53ef\u4ee5\u60f3\u50cf\u7576\u6211\u5011\u628a\u67d0\u500b\u8b8a\u6578\u653e\u5165 dependencies \u9663\u5217\u4e2d\u6642\uff0c\u662f\u5728\u544a\u8a34\u9019\u500b useEffect \u8aaa\uff0c\u5e6b\u6211\u9867\u597d\u9019\u5e7e\u500b\u8b8a\u6578\u5594\uff01\u5982\u679c\u5b83\u5011\u6709\u6539\u8b8a\u7684\u8a71\uff0c\u4f60\u5c31\u8981\u518d\u91cd\u65b0\u505a\u4e00\u6b21\u4e8b\u3002")),Object(b.b)("p",null,"\u53e6\u5916\uff0c\u9019\u500b\u6709\u6c92\u6709\u6539\u8b8a\u7684\u5224\u65b7\uff0c\u5e95\u5c64\u662f\u7528 ",Object(b.b)("inlineCode",{parentName:"p"},"Object.is()")," \u9019\u500b\u65b9\u6cd5\u4f86\u5224\u65b7\uff0c\u5728\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e0b ",Object(b.b)("inlineCode",{parentName:"p"},"Object.is()")," \u548c ",Object(b.b)("inlineCode",{parentName:"p"},"===")," \u7684\u6bd4\u8f03\u7d50\u679c\u90fd\u662f\u76f8\u540c\u7684\uff0c\u9664\u4e86\u7576\u503c\u6709\u53ef\u80fd\u662f ",Object(b.b)("inlineCode",{parentName:"p"},"-0")," \u6216 ",Object(b.b)("inlineCode",{parentName:"p"},"NaN")," \u9019\u5169\u500b\u60c5\u6cc1\uff0c\u5224\u65b7\u65b9\u5f0f\u624d\u6703\u6709\u6240\u4e0d\u540c\u3002"),Object(b.b)("p",null,"\u56e0\u6b64\uff0c\u8b80\u8005\u5011\u53ef\u4ee5\u628a\u9019\u300c\u76f8\u540c\u300d\u7c21\u55ae\u60f3\u6210\u662f\u7528 ",Object(b.b)("inlineCode",{parentName:"p"},"===")," \u4f86\u6bd4\u8f03\uff0c\u56e0\u6b64\u8981\u7279\u5225\u7559\u610f\u7684\u662f\uff0c\u5982\u679c\u4f60\u662f\u5728 dependencies array \u4e2d\u653e\u5165\u300c\u7269\u4ef6\u300d\u6216\u300c\u51fd\u5f0f\u300d\u7684\u8a71\uff0c\u5373\u662f\u5169\u500b\u7269\u4ef6\u4e2d\u7684\u5c6c\u6027\u548c\u503c\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u56e0\u70ba\u7269\u4ef6\u6216\u51fd\u5f0f\u5be6\u969b\u4e0a\u53c3\u7167\u5230\u7684\u662f\u4e0d\u540c\u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e\uff0c\u56e0\u6b64\u5728\u6bd4\u5c0d\u6642\u90fd\u6703\u8a8d\u70ba\u662f\u4e0d\u540c\u7684\u3002"),Object(b.b)("div",{className:"admonition admonition-info alert alert--info"},Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-heading"}),Object(b.b)("h5",{parentName:"div"},Object(b.b)("span",Object(c.a)({parentName:"h5"},{className:"admonition-icon"}),Object(b.b)("svg",Object(c.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(b.b)("path",Object(c.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-content"}),Object(b.b)("p",{parentName:"div"},"\u82e5\u5c0d\u65bc\u7269\u4ef6\u8207\u51fd\u5f0f\u70ba\u4ec0\u9ebc\u6703\u53c3\u7167\u5230\u4e0d\u540c\u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u53c3\u8003 Github \u4e0a\u55ae\u5143\u8aaa\u660e\u9801\u4e2d\u95dc\u65bc\u300c",Object(b.b)("a",Object(c.a)({parentName:"p"},{href:"https://pjchender.blogspot.com/2016/03/javascriptby-referenceby-value.html"}),"\u8ac7\u8ac7 JavaScript \u4e2d by reference \u548c by value \u7684\u91cd\u8981\u89c0\u5ff5"),"\u300d\u7684\u9023\u7d50\u3002"))),Object(b.b)("h2",{id:"useeffect-\u7684-effect-\u6307\u7684\u662f\u4ec0\u9ebc"},"useEffect \u7684 effect \u6307\u7684\u662f\u4ec0\u9ebc"),Object(b.b)("p",null,"\u53e6\u5916\uff0c\u6211\u5011\u77e5\u9053 ",Object(b.b)("inlineCode",{parentName:"p"},"useState")," \u4e2d\u7684 ",Object(b.b)("inlineCode",{parentName:"p"},"state")," \u6307\u7684\u662f\u4fdd\u5b58\u5728 React \u5143\u4ef6\u5167\u90e8\u7684\u8cc7\u6599\u72c0\u614b\uff0c\u90a3\u9ebc ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u4e2d\u7684 ",Object(b.b)("inlineCode",{parentName:"p"},"effect")," \u53c8\u662f\u4ec0\u9ebc\u5462\uff1f"),Object(b.b)("p",null,"\u9019\u500b ",Object(b.b)("strong",{parentName:"p"},"effect")," \u6307\u7684\u662f ",Object(b.b)("strong",{parentName:"p"},"\u526f\u4f5c\u7528\uff08side-effect\uff09")," \u7684\u610f\u601d\uff0c\u5728 React \u4e2d\u6703\u628a\u756b\u9762\u8f49\u8b6f\u5f8c\u548c React \u672c\u8eab\u7121\u95dc\u800c\u9700\u8981\u57f7\u884c\u7684\u52d5\u4f5c\u7a31\u505a\u300c\u526f\u4f5c\u7528\u300d\uff0c\u9019\u4e9b\u52d5\u4f5c\u50cf\u662f\u300c\u767c\u9001 API \u8acb\u6c42\u8cc7\u6599\u300d\u3001\u300c\u624b\u52d5\u66f4\u6539 DOM \u756b\u9762\u300d\u7b49\u7b49\u3002"),Object(b.b)("p",null,"\u526f\u4f5c\u7528\uff08side-effect\uff09\u53c8\u7c21\u7a31\u70ba ",Object(b.b)("strong",{parentName:"p"},"effect"),"\uff0c\u5c31\u4f7f\u7528 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u9019\u500b\u8a5e\uff0c\u800c ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u5e36\u5165\u7684\u51fd\u5f0f\u4e3b\u8981\u5c31\u662f\u7528\u4f86\u8655\u7406\u9019\u4e9b\u526f\u4f5c\u7528\uff0c\u56e0\u6b64\u5e36\u5165 ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u5167\u7684\u51fd\u5f0f\u4e5f\u6703\u88ab\u7a31\u4f5c ",Object(b.b)("inlineCode",{parentName:"p"},"effect"),"\u3002"),Object(b.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-heading"}),Object(b.b)("h5",{parentName:"div"},Object(b.b)("span",Object(c.a)({parentName:"h5"},{className:"admonition-icon"}),Object(b.b)("svg",Object(c.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(b.b)("path",Object(c.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(b.b)("div",Object(c.a)({parentName:"div"},{className:"admonition-content"}),Object(b.b)("p",{parentName:"div"},"\u300c\u624b\u52d5\u66f4\u6539 DOM \u756b\u9762\u300d\u6307\u7684\u662f\u900f\u904e\u700f\u89bd\u5668\u539f\u751f\u7684 API \u6216\u5176\u4ed6\u7b2c\u4e09\u65b9\u5957\u4ef6\u53bb\u64cd\u4f5c DOM\uff0c\u800c\u4e0d\u662f\u900f\u904e\u8b93 React \u5143\u4ef6\u5167 ",Object(b.b)("inlineCode",{parentName:"p"},"state")," \u6539\u8b8a\u800c\u66f4\u65b0\u756b\u9762\u5448\u73fe\u7684\u65b9\u5f0f\u3002"))),Object(b.b)("h2",{id:"\u63db\u4f60\u4e86\uff01\u8b93\u9801\u9762\u4e00\u8f09\u5165\u5c31\u81ea\u52d5\u66f4\u65b0\u8cc7\u6599\u5427"},"\u63db\u4f60\u4e86\uff01\u8b93\u9801\u9762\u4e00\u8f09\u5165\u5c31\u81ea\u52d5\u66f4\u65b0\u8cc7\u6599\u5427"),Object(b.b)("p",null,"\u73fe\u5728\u8981\u8acb\u4f60\u5be6\u969b\u900f\u904e ",Object(b.b)("inlineCode",{parentName:"p"},"useEffect")," \u9019\u500b\u65b9\u6cd5\uff0c\u7576\u756b\u9762\u8f09\u5165\u6642\u5c31\u81ea\u52d5\u62c9\u53d6\u6700\u65b0\u7684\u89c0\u6e2c\u8cc7\u6599\uff01\u73fe\u5728\uff0c\u4f60\u53ef\u4ee5\u53c3\u8003\u4e0b\u9762\u4e86\u6d41\u7a0b\uff1a"),Object(b.b)("ul",{className:"contains-task-list"},Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u95dc\u9589 ",Object(b.b)("inlineCode",{parentName:"li"},"index.js")," \u4e2d\u7684 ",Object(b.b)("inlineCode",{parentName:"li"},"<React.StrictMode>")),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u5728 App \u5143\u4ef6\u4e2d\u4f7f\u7528 ",Object(b.b)("inlineCode",{parentName:"li"},"useEffect")," \u65b9\u6cd5\uff0c\u4e26\u642d\u914d ",Object(b.b)("inlineCode",{parentName:"li"},"console.log")," \u89c0\u5bdf useEffect \u4e2d\u51fd\u5f0f\u88ab\u57f7\u884c\u7684\u6642\u9593\u9ede"),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u628a ",Object(b.b)("inlineCode",{parentName:"li"},"handleClick")," \u65b9\u6cd5\u6539\u540d\u70ba ",Object(b.b)("inlineCode",{parentName:"li"},"fetchCurrentWeather")),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u5728 ",Object(b.b)("inlineCode",{parentName:"li"},"useEffect")," \u7684\u51fd\u5f0f\u4e2d\u547c\u53eb ",Object(b.b)("inlineCode",{parentName:"li"},"fetchCurrentWeather"),"\uff08\u53ef\u80fd\u6703\u51fa\u73fe\u7121\u7aae\u8ff4\u5708\uff09"),Object(b.b)("li",Object(c.a)({parentName:"ul"},{className:"task-list-item"}),Object(b.b)("input",Object(c.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u5728 dependencies \u9663\u5217\u4e2d\u653e\u5165\u7a7a\u9663\u5217 ",Object(b.b)("inlineCode",{parentName:"li"},"[]"),"\uff0c\u89c0\u5bdf ",Object(b.b)("inlineCode",{parentName:"li"},"useEffect")," \u4e2d\u51fd\u5f0f\u662f\u5426\u518d\u6b21\u88ab\u547c\u53eb")),Object(b.b)("p",null,"\u672c\u55ae\u5143\u76f8\u95dc\u4e4b\u7db2\u9801\u9023\u7d50\u3001\u5b8c\u6574\u7a0b\u5f0f\u78bc\uff0c\u4ee5\u53ca\u7a0b\u5f0f\u78bc\u8b8a\u66f4\u90e8\u5206\u53ef\u65bc ",Object(b.b)("inlineCode",{parentName:"p"},"fetch-data-when-page-loaded-with-useEffect")," \u5206\u652f\u6aa2\u8996\uff1a",Object(b.b)("a",Object(c.a)({parentName:"p"},{href:"https://github.com/pjchender/learn-react-from-hook-realtime-weather-app/tree/fetch-data-when-page-loaded-with-useEffect"}),"https://github.com/pjchender/learn-react-from-hook-realtime-weather-app/tree/fetch-data-when-page-loaded-with-useEffect")),Object(b.b)("p",null,Object(b.b)("img",Object(c.a)({parentName:"p"},{src:"https://i.imgur.com/mAazRN2.png",alt:"Imgur"}))),Object(b.b)("hr",null),Object(b.b)("p",null,"\u5716\u7247\u4e2d\u7684\u6587\u5b57\u5167\u5bb9\uff1a"),Object(b.b)("h3",{id:"\u5716\u4e00"},"\u5716\u4e00"),Object(b.b)("p",null,"invoke function component\uff1a\u958b\u59cb\u57f7\u884c\u5143\u4ef6"),Object(b.b)("p",null,"render\uff1a\u8f49\u8b6f\u5143\u4ef6"),Object(b.b)("p",null,"execute function in useEffect\uff1a\u57f7\u884c useEffect \u5167\u7684\u51fd\u5f0f"),Object(b.b)("h3",{id:"\u5716\u4e8c"},"\u5716\u4e8c"),Object(b.b)("p",null,"\u756b\u9762\u8f49\u8b6f\nuseEffect \u5167\u7684 fetchCurrentWeather \u88ab\u57f7\u884c\nsetCurrentWeather \u88ab\u547c\u53eb\n\u756b\u9762\u53c8\u91cd\u65b0\u8f49\u8b6f"),Object(b.b)("h3",{id:"\u5716\u4e09"},"\u5716\u4e09"),Object(b.b)("p",null,"\u756b\u9762\u8f49\u8b6f\n\u7b2c\u4e00\u6b21\u8f49\u8b6f\u5f8c\nuseEffect \u5167\u7684 fetchCurrentWeather \u88ab\u57f7\u884c\nsetCurrentWeather \u88ab\u547c\u53eb\n\u7b2c\u4e8c\u8f49\u8b6f\u5f8c dependencies \u6c92\u6709\u6539\u8b8a"))}o.isMDXComponent=!0},161:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return j}));var c=n(0),a=n.n(c);function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,c,a=function(e,t){if(null==e)return{};var n,c,a={},b=Object.keys(e);for(c=0;c<b.length;c++)n=b[c],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(c=0;c<b.length;c++)n=b[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),o=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},s=function(e){var t=o(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=a.a.forwardRef((function(e,t){var n=e.components,c=e.mdxType,b=e.originalType,i=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),s=o(n),u=c,j=s["".concat(i,".").concat(u)]||s[u]||d[u]||b;return n?a.a.createElement(j,r(r({ref:t},l),{},{components:n})):a.a.createElement(j,r({ref:t},l))}));function j(e,t){var n=arguments,c=t&&t.mdxType;if("string"==typeof e||c){var b=n.length,i=new Array(b);i[0]=u;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r.mdxType="string"==typeof e?e:c,i[1]=r;for(var l=2;l<b;l++)i[l]=n[l];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);