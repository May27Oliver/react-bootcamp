(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{126:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"metadata",(function(){return b})),a.d(t,"toc",(function(){return i})),a.d(t,"default",(function(){return p}));var n=a(3),o=a(7),c=(a(0),a(184)),r={title:"6-5 \u5efa\u7acb\u81ea\u5df1\u7684\u9264\u5b50 - Custom Hooks",keywords:["React Hooks","custom hooks"]},b={unversionedId:"book/ch6/6-5",id:"book/ch6/6-5",isDocsHomePage:!1,title:"6-5 \u5efa\u7acb\u81ea\u5df1\u7684\u9264\u5b50 - Custom Hooks",description:"\u672c\u55ae\u5143\u5c0d\u61c9\u7684\u5c08\u6848\u5206\u652f\u70ba\uff1acustom-hooks\u3002",source:"@site/docs/book/ch6/6-5.md",slug:"/book/ch6/6-5",permalink:"/react-bootcamp/docs/book/ch6/6-5",editUrl:"https://github.com/pjchender/react-bootcamp/edit/main/docs/book/ch6/6-5.md",version:"current",sidebar:"book",previous:{title:"6-4 \u5c08\u6848\u7a0b\u5f0f\u78bc\u91cd\u69cb",permalink:"/react-bootcamp/docs/book/ch6/6-4"},next:{title:"7-1 \u8655\u7406\u4e0d\u540c\u652f API \u9700\u5e36\u5165\u4e0d\u540c\u5730\u5340\u540d\u7a31\u7684\u554f\u984c",permalink:"/react-bootcamp/docs/book/ch7/7-1"}},i=[{value:"\u55ae\u5143\u6838\u5fc3",id:"\u55ae\u5143\u6838\u5fc3",children:[]},{value:"Custom Hook \u7684\u6982\u5ff5",id:"custom-hook-\u7684\u6982\u5ff5",children:[]},{value:"\u65b0\u589e useWeatherAPI \u7684 Hook",id:"\u65b0\u589e-useweatherapi-\u7684-hook",children:[]},{value:"\u5b9a\u7fa9 Custom Hook \u5167\u7684\u529f\u80fd",id:"\u5b9a\u7fa9-custom-hook-\u5167\u7684\u529f\u80fd",children:[]},{value:"\u8b93 Custom Hook \u53ef\u4ee5\u63a5\u6536\u53c3\u6578",id:"\u8b93-custom-hook-\u53ef\u4ee5\u63a5\u6536\u53c3\u6578",children:[]},{value:"\u4f7f\u7528 Custom Hook",id:"\u4f7f\u7528-custom-hook",children:[]},{value:"\u63db\u4f60\u4e86\uff01\u5efa\u7acb\u81ea\u5df1\u7684 Hook",id:"\u63db\u4f60\u4e86\uff01\u5efa\u7acb\u81ea\u5df1\u7684-hook",children:[]}],l={toc:i};function p(e){var t=e.components,a=Object(o.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"\u672c\u55ae\u5143\u5c0d\u61c9\u7684\u5c08\u6848\u5206\u652f\u70ba\uff1a",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pjchender/learn-react-from-hook-realtime-weather-app/tree/custom-hooks"}),"custom-hooks"),"\u3002"),Object(c.b)("h2",{id:"\u55ae\u5143\u6838\u5fc3"},"\u55ae\u5143\u6838\u5fc3"),Object(c.b)("p",null,"\u9019\u500b\u55ae\u5143\u7684\u4e3b\u8981\u76ee\u6a19\u5305\u542b\uff1a"),Object(c.b)("ul",{className:"contains-task-list"},Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u4e86\u89e3\u5982\u4f55\u5c07\u91cd\u8907\u7684\u908f\u8f2f\u6574\u7406\u6210\u81ea\u5df1\u53ef\u4f7f\u7528\u7684 Hooks")),Object(c.b)("hr",null),Object(c.b)("p",null,"\u5ef6\u7e8c\u4e0a\u4e00\u500b\u55ae\u5143\u5c08\u6848\u7a0b\u5f0f\u78bc\u7684\u91cd\u69cb\uff0c\u73fe\u5728\u91cd\u69cb\u5f8c\u7684 ",Object(c.b)("inlineCode",{parentName:"p"},"App.js")," \u4e2d\uff0c\u96d6\u7136\u5df2\u7d93\u6bd4\u8d77\u539f\u672c\u7684\u7a0b\u5f0f\u78bc\u4e7e\u6de8\u8a31\u591a\uff0c\u57fa\u672c\u4e0a\u53ea\u505a\u4e86\u62c9\u53d6\u8cc7\u6599\u7684\u52d5\u4f5c\uff0c\u4f46\u56e0\u70ba ",Object(c.b)("inlineCode",{parentName:"p"},"fetchCurrentWeather")," \u548c ",Object(c.b)("inlineCode",{parentName:"p"},"fetchWeatherForecast")," \u672c\u8eab\u4e5f\u505a\u4e86\u4e0d\u5c11\u4e8b\u60c5\uff0c\u53d6\u5f97\u8cc7\u6599\u4e4b\u5f8c\u53c8\u8981\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"p"},"setWeatherElement")," \u628a\u8cc7\u6599\u5b58\u5230 React \u5143\u4ef6\u4e2d\uff0c\u6211\u5011\u6709\u6c92\u6709\u4ec0\u9ebc\u65b9\u5f0f\u8b93\u9019\u500b\u5143\u4ef6\u518d\u66f4\u4e7e\u6de8\u4e00\u4e9b\u5462\uff1f"),Object(c.b)("p",null,"\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u5728 React \u4e2d\uff0c\u6211\u5011\u4e0d\u53ea\u80fd\u5920\u4f7f\u7528 React \u9810\u5148\u5b9a\u7fa9\u597d\u7684 Hooks\uff0c\u50cf\u662f\u4e4b\u524d\u4f7f\u7528\u7684 ",Object(c.b)("inlineCode",{parentName:"p"},"useState"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"useEffect"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"useMemo")," \u9019\u4e9b\uff0c\u9084\u53ef\u4ee5\u81ea\u5df1\u81ea\u8a02 Hook\u3002\u81ea\u8a02\u7684 Hook \u53ef\u4ee5\u5e6b\u6211\u5011\u628a\u8f03\u8907\u96dc\u7684\u7a0b\u5f0f\u908f\u8f2f\u62bd\u5230 Hook \u5167\uff0c\u4e26\u4e14\u53ef\u4ee5\u5728\u591a\u500b\u5143\u4ef6\u5167\u91cd\u8907\u4f7f\u7528\u5916\uff0c\u751a\u81f3\u4e5f\u53ef\u4ee5\u6253\u5305\u8d77\u4f86\uff0c\u653e\u5230\u958b\u6e90\u793e\u7fa4\u5206\u4eab\u7d66\u6709\u540c\u6a23\u9700\u6c42\u7684\u4eba\u4f7f\u7528\u3002"),Object(c.b)("p",null,"\u73fe\u5728\u5c31\u8b93\u6211\u5011\u4f86\u770b\u770b\u600e\u9ebc\u6a23\u5b9a\u7fa9\u81ea\u5df1\u7684 Hook \u5427\uff01"),Object(c.b)("h2",{id:"custom-hook-\u7684\u6982\u5ff5"},"Custom Hook \u7684\u6982\u5ff5"),Object(c.b)("p",null,"\u81ea\u8a02 Hook\uff08Custom Hook\uff09\u7684\u6982\u5ff5\u5176\u5be6\u5f88\u7c21\u55ae\uff0c\u5b83\u548c\u4f60\u4e4b\u524d\u5beb\u7684 React Component \u57fa\u672c\u4e0a\u662f\u4e00\u6a23\u7684\uff0c\u90fd\u662f JavaScript \u7684\u51fd\u5f0f\uff0c\u800c\u4e14\u5728 Custom Hook \u4e2d\u4e00\u6a23\u53ef\u4ee5\u4f7f\u7528 ",Object(c.b)("inlineCode",{parentName:"p"},"useState"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"useEffect")," \u9019\u4e9b\u539f\u672c React \u5c31\u6709\u63d0\u4f9b\u7684 Hooks\uff0c",Object(c.b)("strong",{parentName:"p"},"\u53ea\u662f\u5728 React Component \u4e2d\u6700\u5f8c\u4f60\u6703\u56de\u50b3\u7684\u662f JSX\uff0c\u800c\u5728 Hook \u4e2d\u6700\u5f8c\u56de\u50b3\u7684\u662f\u4e00\u4e9b\u8cc7\u6599\u6216\u6539\u8b8a\u8cc7\u6599\u7684\u65b9\u6cd5"),"\u3002\u6b64\u5916\uff0c\u5728\u81ea\u8a02\u7684 Hook \u4e2d\uff0c\u6703\u9075\u5faa React Hooks \u7684\u6163\u4f8b\uff0c\u56e0\u6b64\u6703\u4f7f\u7528 ",Object(c.b)("inlineCode",{parentName:"p"},"use")," \u958b\u982d\u4f86\u70ba\u8a72\u51fd\u5f0f\u547d\u540d\u3002"),Object(c.b)("p",null,"\u6240\u4ee5\u57fa\u672c\u4e0a\u4f60\u6703\u5efa\u7acb React Component \u7684\u8a71\uff0c\u5c31\u6703\u81ea\u8a02 Hook\u3002\u53e6\u5916\uff0c\u81ea\u8a02\u7684 Hook \u4e00\u6a23\u8981\u9075\u5b88\u539f\u672c React Hooks \u7684\u539f\u5247\uff0c\u50cf\u662f Hook \u53ea\u80fd\u5728 React \u7684 Functional Component \u4e2d\u4f7f\u7528\uff08\u904e\u53bb React Component \u9664\u4e86\u51fd\u5f0f\u4e4b\u5916\uff0c\u4e5f\u53ef\u4ee5\u7528 ",Object(c.b)("inlineCode",{parentName:"p"},"class")," \u5efa\u7acb\uff09\u3001Hook \u4e0d\u80fd\u653e\u5728\u8ff4\u5708\u6216 ",Object(c.b)("inlineCode",{parentName:"p"},"if")," \u5224\u65b7\u5f0f\u5167\u7b49\u7b49\u3002"),Object(c.b)("h2",{id:"\u65b0\u589e-useweatherapi-\u7684-hook"},"\u65b0\u589e useWeatherAPI \u7684 Hook"),Object(c.b)("p",null,"\u73fe\u5728\u5c31\u8b93\u6211\u5011\u4f86\u5efa\u7acb\u4e00\u500b\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u7684 Hook\uff0c\u5728\u9019\u500b Hook \u4e2d\u6703\u5e6b\u52a9\u6211\u5011\u53bb\u5411\u4e2d\u592e\u6c23\u8c61\u5c40\u767c\u9001 API \u8acb\u6c42\uff0c\u4e26\u4e14\u56de\u50b3\u53d6\u5f97\u7684\u8cc7\u6599\u3002"),Object(c.b)("p",null,"\u5148\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"./src")," \u8cc7\u6599\u593e\u4e2d\u5efa\u7acb\u4e00\u500b\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"p"},"hooks")," \u8cc7\u6599\u593e\uff0c\u4e26\u65b0\u589e\u4e00\u652f\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI.js")," \u7684\u6a94\u6848\uff0c\u5728\u88e1\u9762\u5b9a\u7fa9\u4e00\u500b\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u7684\u51fd\u5f0f\uff0c\u4e26\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"p"},"export")," \u532f\u51fa\uff1a"),Object(c.b)("p",null,Object(c.b)("img",Object(n.a)({parentName:"p"},{src:"https://i.imgur.com/rf0oLPi.png",alt:"Imgur"}))),Object(c.b)("p",null,"\u5176\u5be6\u548c\u5efa\u7acb React Component \u7684\u6b65\u9a5f\u4e00\u6a23\u5427\uff01"),Object(c.b)("h2",{id:"\u5b9a\u7fa9-custom-hook-\u5167\u7684\u529f\u80fd"},"\u5b9a\u7fa9 Custom Hook \u5167\u7684\u529f\u80fd"),Object(c.b)("p",null,"\u63a5\u4e0b\u4f86\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u9019\u500b\u51fd\u5f0f\u4e2d\uff0c\u5c31\u53ef\u4ee5\u4f86\u5411\u4e2d\u592e\u6c23\u8c61\u5c40\u767c\u9001 API \u8acb\u6c42\u5929\u6c23\u8cc7\u6599\uff0c\u9019\u500b\u90e8\u5206\u56e0\u70ba\u5148\u524d\u90fd\u5beb\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"App.js")," \u4e2d\u4e86\uff0c\u56e0\u6b64\u628a\u9019\u500b\u90e8\u5206\u526a\u4e0b\u8cbc\u4e0a\u5c31\u597d\u3002"),Object(c.b)("p",null,"\u5148\u628a\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"App.js")," \u4e2d\u5b9a\u7fa9\u7684 ",Object(c.b)("inlineCode",{parentName:"p"},"fetchCurrentWeather"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"fetchWeatherForecast")," \u9019\u5169\u500b\u51fd\u5f0f\u526a\u4e0b\uff0c\u8cbc\u5230 ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI.js")," \u4e2d\uff1a"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// ./src/hooks/useWeatherAPI.js\nconst fetchCurrentWeather = () => {\n  /* ... */\n};\n\nconst fetchWeatherForecast = () => {\n  /* ... */\n};\n\nconst useWeatherAPI = () => {};\n\nexport default useWeatherAPI;\n")),Object(c.b)("p",null,"\u63a5\u8457\u628a\u539f\u672c\u5beb\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"App")," \u5143\u4ef6\u4e2d\u548c\u62c9\u53d6\u5929\u6c23\u8cc7\u6599\u6709\u95dc\u7684\u90e8\u5206\uff0c\u642c\u5230\u9019\u500b ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u9019\u500b Hook \u5167\uff0c\u5176\u4e2d\u5305\u542b\uff1a"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"\u532f\u5165 react \u5957\u4ef6\u63d0\u4f9b\u7684 ",Object(c.b)("inlineCode",{parentName:"li"},"useState"),", ",Object(c.b)("inlineCode",{parentName:"li"},"useEffect"),", ",Object(c.b)("inlineCode",{parentName:"li"},"useCallback")," \u65b9\u6cd5\u3002\u5728 Custom Hooks \u4e2d\u56e0\u70ba\u6700\u5f8c\u4e0d\u6703\u56de\u50b3 JSX\uff0c\u56e0\u6b64",Object(c.b)("strong",{parentName:"li"},"\u4e0d\u9700\u8981\u532f\u5165 react \u5957\u4ef6\u63d0\u4f9b\u7684 React \u7269\u4ef6"),"\uff1a")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// ./src/hooks/useWeatherAPI.js\nimport { useState, useEffect, useCallback } from 'react';\n")),Object(c.b)("ol",{start:2},Object(c.b)("li",{parentName:"ol"},Object(c.b)("inlineCode",{parentName:"li"},"useState")," \u4e2d\u7528\u4f86\u5b9a\u7fa9 ",Object(c.b)("inlineCode",{parentName:"li"},"weatherElement")," \u7684\u90e8\u5206")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// ./src/hooks/useWeatherAPI.js\nconst useWeatherAPI = () => {\n  // STEP 2\uff1auseState \u4e2d\u7528\u4f86\u5b9a\u7fa9 weatherElement \u7684\u90e8\u5206\n  const [weatherElement, setWeatherElement] = useState({\n    /* ... */\n  });\n};\n")),Object(c.b)("ol",{start:3},Object(c.b)("li",{parentName:"ol"},"\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"li"},"useCallback")," \u7528\u4f86\u5b9a\u7fa9 ",Object(c.b)("inlineCode",{parentName:"li"},"fetchData()")," \u7684\u90e8\u5206")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// ./src/hooks/useWeatherAPI.js\nconst useWeatherAPI = () => {\n  const [weatherElement, setWeatherElement] = useState({\n    /* ... */\n  });\n\n  // STEP 3\uff1a\u900f\u904e useCallback \u7528\u4f86\u5b9a\u7fa9 fetchData() \u7684\u90e8\u5206\n  const fetchData = useCallback(async () => {\n    /* ... */\n  }, []);\n};\n")),Object(c.b)("ol",{start:4},Object(c.b)("li",{parentName:"ol"},"\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"li"},"useEffect")," \u7528\u4f86\u547c\u53eb ",Object(c.b)("inlineCode",{parentName:"li"},"fetchData")," \u7684\u90e8\u5206")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"const useWeatherAPI = () => {\n  const [weatherElement, setWeatherElement] = useState({\n    /* ... */\n  });\n  const fetchData = useCallback(async () => {\n    /* ... */\n  }, []);\n\n  // STEP 4\uff1a\u900f\u904e useEffect \u7528\u4f86\u547c\u53eb fetchData \u7684\u90e8\u5206\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n};\n")),Object(c.b)("ol",{start:5},Object(c.b)("li",{parentName:"ol"},"\u6700\u5f8c\u4e00\u500b\u6b65\u9a5f\u662f\u548c\u4e00\u822c React \u5143\u4ef6\u6700\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u4e00\u822c\u7684 React \u5143\u4ef6\u6700\u7d42\u901a\u5e38\u90fd\u662f\u56de\u50b3 JSX\uff0c\u4f46\u5728 Custom Hooks \u4e2d\u6700\u5f8c\u6703 ",Object(c.b)("inlineCode",{parentName:"li"},"return")," \u7684\u662f\u53ef\u4ee5\u8b93\u5176\u4ed6 React \u5143\u4ef6\u4f7f\u7528\u7684\u8cc7\u6599\u6216\u65b9\u6cd5\u3002\u9019\u5c31\u50cf\u7576\u6211\u5011\u547c\u53eb ",Object(c.b)("inlineCode",{parentName:"li"},"useState")," \u662f\u6703\u5f97\u5230\u4e00\u500b\u8cc7\u6599\u72c0\u614b\u548c\u7528\u4f86\u6539\u8b8a\u8cc7\u6599\u72c0\u614b\u7684\u65b9\u6cd5\u3002\u6240\u4ee5\u9019\u88e1\u6211\u5011\u6703\u56de\u50b3\u7528\u4f86\u62c9\u53d6\u8cc7\u6599\u7684\u65b9\u6cd5\uff08",Object(c.b)("inlineCode",{parentName:"li"},"fetchData"),"\uff09\u548c\u62c9\u53d6\u8cc7\u6599\u5f8c\u53d6\u5f97\u7684\u5929\u6c23\u8cc7\u6599\uff08",Object(c.b)("inlineCode",{parentName:"li"},"weatherElement"),"\uff09")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"const useWeatherAPI = () => {\n  const [weatherElement, setWeatherElement] = useState({\n    /* ... */\n  });\n  const fetchData = useCallback(async () => {\n    /* ... */\n  }, []);\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  // STEP 5\uff1a\u56de\u50b3\u8981\u8b93\u5176\u4ed6\u5143\u4ef6\u4f7f\u7528\u7684\u8cc7\u6599\u6216\u65b9\u6cd5\n  return [weatherElement, fetchData];\n};\n")),Object(c.b)("p",null,"\u73fe\u5728\u6211\u5011\u5c31\u5b9a\u7fa9\u597d\u4e86 ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u9019\u500b Custom Hook\u3002"),Object(c.b)("h2",{id:"\u8b93-custom-hook-\u53ef\u4ee5\u63a5\u6536\u53c3\u6578"},"\u8b93 Custom Hook \u53ef\u4ee5\u63a5\u6536\u53c3\u6578"),Object(c.b)("p",null,"Custom Hook \u672c\u8cea\u4e0a\u4e5f\u662f\u500b\u51fd\u5f0f\uff0c\u6240\u4ee5\u5b83\u4e5f\u53ef\u900f\u904e\u53c3\u6578\u7684\u65b9\u5f0f\u53d6\u5f97\u8cc7\u6599\u3002\u73fe\u5728\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u4e2d\uff0c\u6211\u5011\u9084\u7f3a\u5c11\u5e7e\u500b\u8cc7\u6599\uff0c\u50cf\u662f ",Object(c.b)("inlineCode",{parentName:"p"},"AUTHORIZATION_KEY"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"LOCATION_NAME")," \u548c ",Object(c.b)("inlineCode",{parentName:"p"},"LOCATION_NAME_FORECAST"),"\uff0c\u9019\u4e9b\u8cc7\u6599\u539f\u672c\u662f\u653e\u5728 App \u5143\u4ef6\u4e2d\uff0c\u70ba\u4e86\u8981\u8b93 ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI")," \u4e5f\u80fd\u53d6\u5f97\u9019\u4e9b\u8cc7\u6599\uff0c\u53ef\u4ee5\u900f\u904e\u51fd\u5f0f\u7684\u53c3\u6578\u628a\u8cc7\u6599\u5e36\u9032\u4f86\uff1a"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"const useWeatherAPI = ({ locationName, cityName, authorizationKey }) => {\n  /* ... */\n};\n")),Object(c.b)("p",null,"\u9019\u88e1\u53ef\u4ee5\u770b\u5230\u7528\u4f86\u53d6\u5f97\u5373\u6642\u5929\u6c23\u7684 API\uff08",Object(c.b)("inlineCode",{parentName:"p"},"fetchCurrentWeather"),"\uff09\u9700\u8981\u5e36\u5165\u7684\u662f\u5730\u5340\uff08\u5373\u300c\u81fa\u5317\u300d\uff09\uff1b\u7528\u4f86\u53d6\u5f97\u5929\u6c23\u9810\u5831\u7684 API\uff08",Object(c.b)("inlineCode",{parentName:"p"},"fetchWeatherForecast"),"\uff09\u9700\u8981\u5e36\u5165\u7684\u662f\u7e23\u5e02\u540d\u7a31\uff08\u5373\u300c\u81fa\u5317\u5e02\u300d\uff09\uff0c\u4e4b\u6240\u4ee5\u6703\u6709\u9019\u6a23\u7684\u5dee\u5225\uff0c\u4e3b\u8981\u662f\u56e0\u70ba\u4e2d\u592e\u6c23\u8c61\u5c40\u5728\u9019\u5169\u9053 API \u9700\u8981\u7684\u8cc7\u6599\u4e0d\u540c\u3002\u70ba\u4e86\u8b93\u8b8a\u6578\u7684\u8a9e\u610f\u66f4\u6e05\u695a\uff0c\u6211\u5011\u628a ",Object(c.b)("inlineCode",{parentName:"p"},"LOCATION_NAME_FORECAST")," \u6539\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"p"},"cityName"),"\u3002"),Object(c.b)("p",null,"\u73fe\u5728\u9032\u4e00\u6b65\u628a\u9019\u500b\u8b8a\u6578\u5e36\u5165 ",Object(c.b)("inlineCode",{parentName:"p"},"fetchCurrentWeather")," \u548c ",Object(c.b)("inlineCode",{parentName:"p"},"fetchWeatherForecast")," \u4e2d\uff1a"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// ./src/hooks/useWeatherAPI.js\nconst fetchCurrentWeather = ({ authorizationKey, locationName }) => {\n  return fetch(\n    `https://opendata.cwb.gov.tw/api/v1/rest/datastore/O-A0003-001?\n      Authorization=${authorizationKey}&\n      locationName=${locationName}`\n  ).then(/* ... */);\n};\n\nconst fetchWeatherForecast = ({ authorizationKey, cityName }) => {\n  return fetch(\n    `https://opendata.cwb.gov.tw/api/v1/rest/datastore/F-C0032-001?\n      Authorization=${authorizationKey}&\n      locationName=${cityName}`\n  ).then(/* ... */);\n};\n")),Object(c.b)("p",null,"\u63a5\u8457\u5728 useWeatherAPI \u7684\u51fd\u5f0f\u4e2d\uff0c\u4e00\u6a23\u900f\u904e\u53c3\u6578\u628a\u8cc7\u6599\u5e36\u5165\u9019\u5169\u500b\u65b9\u6cd5\uff1a"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"\u628a ",Object(c.b)("inlineCode",{parentName:"li"},"authorizationKey"),", ",Object(c.b)("inlineCode",{parentName:"li"},"locationName"),", ",Object(c.b)("inlineCode",{parentName:"li"},"cityName")," \u50b3\u5230\u62c9\u53d6 API \u7684\u65b9\u6cd5\u4e2d"),Object(c.b)("li",{parentName:"ol"},"\u5728 useCallback \u4e2d\u8981\u8a18\u5f97\u628a\u8b8a\u6578\u653e\u5165 dependencies array \u4e2d\uff0c\u4ee5\u78ba\u4fdd\u9019\u4e9b\u8cc7\u6599\u6539\u8b8a\u6642\uff0c\u80fd\u5920\u5f97\u5230\u6700\u65b0\u7684 fetchData \u65b9\u6cd5")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"const useWeatherAPI = ({ locationName, cityName, authorizationKey }) => {\n  const [weatherElement, setWeatherElement] = useState({\n    /* ... */\n  });\n\n  const fetchData = useCallback(async () => {\n    // ...\n    const [currentWeather, weatherForecast] = await Promise.all([\n      // STEP 1\uff1a\u628a authorizationKey, locationName, cityName \u50b3\u5230\u62c9\u53d6 API \u7684\u65b9\u6cd5\u4e2d\n      fetchCurrentWeather({ authorizationKey, locationName }),\n      fetchWeatherForecast({ authorizationKey, cityName }),\n    ]);\n    // ...\n    // STEP 2\uff1a\u5728 useCallback \u4e2d\u8981\u8a18\u5f97\u628a\u8b8a\u6578\u653e\u5165 dependencies array \u4e2d\n  }, [authorizationKey, cityName, locationName]);\n  // ...\n};\n")),Object(c.b)("h2",{id:"\u4f7f\u7528-custom-hook"},"\u4f7f\u7528 Custom Hook"),Object(c.b)("p",null,"\u7576\u6211\u5011\u628a\u62c9\u53d6\u5929\u6c23\u8cc7\u6599\u7684\u9019\u4e00\u6574\u500b\u6d41\u7a0b\u5305\u6210 Custom Hook \u4e4b\u5f8c\uff0c\u5728\u9700\u8981\u4f7f\u7528\u5230\u5929\u6c23\u8cc7\u6599\u7684 React \u5143\u4ef6\u4e2d\uff0c\u90fd\u53ef\u4ee5\u900f\u904e\u5b83\u5c31\u53ef\u4ee5\u53d6\u5f97\u4e2d\u592e\u6c23\u8c61\u5c40\u56de\u50b3\u7684\u8cc7\u6599\u3002"),Object(c.b)("p",null,"\u4f7f\u7528\u65b9\u5f0f\u975e\u5e38\u7c21\u55ae\uff0c\u5c31\u548c\u4f7f\u7528\u5176\u4ed6\u7684 React Hooks \u4e00\u6a23\uff0c\u73fe\u5728\u5c31\u8b93\u6211\u5011\u5728 ",Object(c.b)("inlineCode",{parentName:"p"},"App.js")," \u4e2d\u4f86\u4f7f\u7528 ",Object(c.b)("inlineCode",{parentName:"p"},"useWeatherAPI"),"\uff1a"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"li"},"import")," \u8f09\u5165 ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI")," \u9019\u500b Custom Hook"),Object(c.b)("li",{parentName:"ol"},"\u76f4\u63a5\u547c\u53eb ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI")," \u5f8c\u5c31\u80fd\u53d6\u5f97\u8a72 Hook \u56de\u50b3\u7684 ",Object(c.b)("inlineCode",{parentName:"li"},"weatherElement")," \u548c ",Object(c.b)("inlineCode",{parentName:"li"},"fetchData")," \u65b9\u6cd5"),Object(c.b)("li",{parentName:"ol"},"\u5728\u547c\u53eb ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI()")," \u4e2d\uff0c\u628a\u5b83\u6240\u9700\u7684\u53c3\u6578 ",Object(c.b)("inlineCode",{parentName:"li"},"locationName"),", ",Object(c.b)("inlineCode",{parentName:"li"},"cityName"),", ",Object(c.b)("inlineCode",{parentName:"li"},"authorizationKey")," \u653e\u9032\u53bb"),Object(c.b)("li",{parentName:"ol"},"\u6574\u500b\u4f7f\u7528\u65b9\u5f0f\u662f\u4e0d\u662f\u5c31\u548c ",Object(c.b)("inlineCode",{parentName:"li"},"useState")," \u975e\u5e38\u985e\u4f3c\u5462\uff1f")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// ./src/App.js\n// STEP 1 \u532f\u5165 useWeatherAPI\nimport useWeatherAPI from './hooks/useWeatherAPI';\n// ...\nconst App = () => {\n  // STEP 2\uff1a\u4f7f\u7528 useWeatherAPI\n  const [weatherElement, fetchData] = useWeatherAPI({\n    locationName: LOCATION_NAME,\n    cityName: LOCATION_NAME_FORECAST,\n    authorizationKey: AUTHORIZATION_KEY,\n  });\n  // ...\n};\n")),Object(c.b)("p",null,"\u7576\u5577\uff5e\u756b\u9762\u53c8\u56de\u4f86\u62c9\uff5e"),Object(c.b)("p",null,Object(c.b)("img",Object(n.a)({parentName:"p"},{src:"https://i.imgur.com/uBFY8Tc.png",alt:"Imgur"}))),Object(c.b)("p",null,"\u57fa\u672c\u4e0a Custom Hook \u7684\u5b9a\u7fa9\u548c\u4f7f\u7528\u90fd\u4e0d\u96e3\uff0c\u5982\u679c\u4f60\u6703\u64b0\u5beb React \u4e2d\u7684 Functional Component\uff0c\u5c31\u4e00\u5b9a\u6703\u64b0\u5beb Custom Hook\u3002\u900f\u904e Custom Hook \uff0c\u53ef\u4ee5\u5e6b\u52a9\u958b\u767c\u8005\u5c07\u5177\u6709\u76f8\u540c\u908f\u8f2f\u7684\u529f\u80fd\u7d71\u6574\u5728\u4e00\u500b Hook \u4e2d\uff0c\u65b9\u4fbf\u91cd\u8907\u4f7f\u7528\u9019\u500b\u51fd\u5f0f\u7684\u529f\u7528\uff01"),Object(c.b)("p",null,"\u5728\u9019\u5169\u500b\u55ae\u5143\u4e2d\u4e00\u53e3\u6c23\u91cd\u69cb\u4e86\u4e0d\u5c11\u7a0b\u5f0f\u78bc\uff0c\u76ee\u7684\u90fd\u662f\u70ba\u4e86\u8b93\u6574\u500b\u5c08\u6848\u5f8c\u7e8c\u66f4\u5bb9\u6613\u7dad\u8b77\uff0c\u81f3\u65bc\u8981\u600e\u9ebc\u5224\u65b7\u597d\u4e0d\u597d\u7dad\u8b77\uff0c\u6700\u7c21\u55ae\u7684\u65b9\u5f0f\u662f\uff1a\u300c\u4e0d\u6c42\u5225\u4eba\u63a5\u624b\u770b\u5f97\u61c2\uff0c\u53ea\u6c42\u81ea\u5df1\u4e00\u500b\u6708\u5f8c\u6253\u958b\u7a0b\u5f0f\u9084\u6539\u5f97\u52d5\u300d\uff0c\u5982\u679c\u73fe\u5728\u5beb\u7684\u6771\u897f\u672a\u4f86\u4e00\u500b\u6708\u5f8c\u81ea\u5df1\u90fd\u770b\u4e0d\u61c2\u7684\u8a71\uff0c\u90a3\u80af\u5b9a\u662f\u4e0d\u592a\u597d\u7dad\u8b77\u3002"),Object(c.b)("h2",{id:"\u63db\u4f60\u4e86\uff01\u5efa\u7acb\u81ea\u5df1\u7684-hook"},"\u63db\u4f60\u4e86\uff01\u5efa\u7acb\u81ea\u5df1\u7684 Hook"),Object(c.b)("p",null,"Custom Hooks \u5728\u64b0\u5beb\u6642\u8981\u5beb\u7684\u662f\u9019\u500b Hook \u5e36\u5165\u4ec0\u9ebc\u6a23\u7684 input \u5f8c\uff0c\u5c07\u53ef\u4ee5\u5f97\u5230\u4ec0\u9ebc\u6a23\u7684 output\uff0c\u8207\u4e00\u822c\u51fd\u5f0f\u7684\u601d\u8def\u883b\u76f8\u8fd1\u7684\u3002"),Object(c.b)("p",null,"\u73fe\u5728\u8981\u8acb\u4f60\u5c07\u8207\u4e2d\u592e\u6c23\u8c61\u5c40\u62c9\u53d6\u8cc7\u6599\u6709\u95dc\u7684 API \u62c6\u5206\u6210\u4e00\u500b\u7368\u7acb\u7684 React Hook\uff0c\u60f3\u8981\u4f7f\u7528\u9019\u500b Hook \u7684\u4eba\uff0c\u53ea\u9700\u8981\u5e36\u5165 ",Object(c.b)("inlineCode",{parentName:"p"},"locationName"),", ",Object(c.b)("inlineCode",{parentName:"p"},"cityName"),", ",Object(c.b)("inlineCode",{parentName:"p"},"authorizationKey")," \u4e4b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u53d6\u5f97\u5c0d\u61c9\u7684\u5929\u6c23\u8cc7\u6599\u3002\u7531\u65bc\u91cd\u69cb\u6642\u7a0b\u5f0f\u78bc\u7684\u8b8a\u52d5\u53ef\u80fd\u6bd4\u8f03\u8907\u96dc\uff0c\u9700\u8981\u7684\u6642\u5019\u90fd\u53ef\u4ee5\u5c0d\u61c9\u6700\u4e0b\u65b9\u7684\u9023\u7d50\u67e5\u770b\u3002\u5be6\u4f5c\u6642\u53ef\u4ee5\u53c3\u8003\u4ee5\u4e0b\u6b65\u9a5f\uff1a"),Object(c.b)("ul",{className:"contains-task-list"},Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u5728 ",Object(c.b)("inlineCode",{parentName:"li"},"./src")," \u8cc7\u6599\u593e\u4e2d\uff0c\u5efa\u7acb\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"li"},"hooks")," \u7684\u8cc7\u6599\u593e\uff0c\u4e26\u5728\u88e1\u9762\u65b0\u589e ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI.js"),"\uff0c\u5728\u6a94\u6848\u4e2d\u5efa\u7acb\u4e00\u500b\u540d\u70ba ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI")," \u7684\u51fd\u5f0f"),Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u628a\u5728 ",Object(c.b)("inlineCode",{parentName:"li"},"App.js")," \u4e2d\u5b9a\u7fa9\u7684 ",Object(c.b)("inlineCode",{parentName:"li"},"fetchCurrentWeather"),"\u3001",Object(c.b)("inlineCode",{parentName:"li"},"fetchWeatherForecast")," \u9019\u5169\u500b\u51fd\u5f0f\u526a\u4e0b\uff0c\u8cbc\u5230 ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI.js")," \u4e2d"),Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u5728 ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI.js")," \u4e2d\u532f\u5165 react \u5957\u4ef6\u63d0\u4f9b\u7684 ",Object(c.b)("inlineCode",{parentName:"li"},"useState"),", ",Object(c.b)("inlineCode",{parentName:"li"},"useEffect"),", ",Object(c.b)("inlineCode",{parentName:"li"},"useCallback")," \u65b9\u6cd5"),Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u628a\u539f\u672c\u5beb\u5728 ",Object(c.b)("inlineCode",{parentName:"li"},"App")," \u5143\u4ef6\u4e2d\u548c\u62c9\u53d6\u5929\u6c23\u8cc7\u6599\u6709\u95dc\u7684\u90e8\u5206\u53ef\u4ee5\u642c\u5230\u9019\u500b ",Object(c.b)("inlineCode",{parentName:"li"},"useWeatherAPI")," \u9019\u500b Hook \u5167\uff0c\u5176\u4e2d\u5305\u542b ",Object(c.b)("inlineCode",{parentName:"li"},"useState")," \u4e2d\u7528\u4f86\u5b9a\u7fa9 ",Object(c.b)("inlineCode",{parentName:"li"},"weatherElement")," \u7684\u90e8\u5206\u3001\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"li"},"useCallback")," \u7528\u4f86\u5b9a\u7fa9 ",Object(c.b)("inlineCode",{parentName:"li"},"fetchData()")," \u7684\u90e8\u5206\u3001\u900f\u904e ",Object(c.b)("inlineCode",{parentName:"li"},"useEffect")," \u7528\u4f86\u547c\u53eb ",Object(c.b)("inlineCode",{parentName:"li"},"fetchData")," \u7684\u90e8\u5206"),Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u628a\u9700\u8981\u5728 App \u5143\u4ef6\u4e2d\u4f7f\u7528\u5230\u7684\u51fd\u5f0f\u548c\u65b9\u6cd5\u65bc useWeatherAPI \u56de\u50b3"),Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u8b93 useWeatherAPI \u53ef\u4ee5\u63a5\u6536\u53c3\u6578\uff08",Object(c.b)("inlineCode",{parentName:"li"},"locationName"),", ",Object(c.b)("inlineCode",{parentName:"li"},"cityName"),", ",Object(c.b)("inlineCode",{parentName:"li"},"authorizationKey"),"\uff09"),Object(c.b)("li",Object(n.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(n.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","\u5728 App \u5143\u4ef6\u4e2d\u4f7f\u7528 useWeatherAPI \u9019\u500b Custom Hook")),Object(c.b)("p",null,"\u672c\u55ae\u5143\u76f8\u95dc\u4e4b\u7db2\u9801\u9023\u7d50\u3001\u5b8c\u6574\u7a0b\u5f0f\u78bc\u8207\u7a0b\u5f0f\u78bc\u8b8a\u66f4\u90e8\u5206\u53ef\u65bc ",Object(c.b)("inlineCode",{parentName:"p"},"custom-hooks")," \u5206\u652f\u6aa2\u8996\uff1a",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pjchender/learn-react-from-hook-realtime-weather-app/tree/custom-hooks"}),"https://github.com/pjchender/learn-react-from-hook-realtime-weather-app/tree/custom-hooks")),Object(c.b)("p",null,Object(c.b)("img",Object(n.a)({parentName:"p"},{src:"https://i.imgur.com/u24Tsu3.png",alt:"Imgur"}))))}p.isMDXComponent=!0},184:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return j}));var n=a(0),o=a.n(n);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=o.a.createContext({}),p=function(e){var t=o.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):b(b({},t),e)),a},s=function(e){var t=p(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,c=e.originalType,r=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),s=p(a),u=n,j=s["".concat(r,".").concat(u)]||s[u]||m[u]||c;return a?o.a.createElement(j,b(b({ref:t},l),{},{components:a})):o.a.createElement(j,b({ref:t},l))}));function j(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var c=a.length,r=new Array(c);r[0]=u;var b={};for(var i in t)hasOwnProperty.call(t,i)&&(b[i]=t[i]);b.originalType=e,b.mdxType="string"==typeof e?e:n,r[1]=b;for(var l=2;l<c;l++)r[l]=a[l];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);